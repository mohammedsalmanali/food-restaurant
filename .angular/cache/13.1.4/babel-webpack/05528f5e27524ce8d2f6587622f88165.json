{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { Cart } from '../shared/models/Cart';\nimport { CartItem } from '../shared/models/CartItem';\nimport * as i0 from \"@angular/core\";\nexport let CartService = /*#__PURE__*/(() => {\n  class CartService {\n    constructor() {\n      this.cart = this.getCartFromLocalStorage();\n      this.cartSubject = new BehaviorSubject(this.cart);\n    }\n\n    addToCart(food) {\n      let cartItem = this.cart.items.find(item => item.food.id === food.id);\n      if (cartItem) return;\n      this.cart.items.push(new CartItem(food));\n      this.setCartToLocalStorage();\n    }\n\n    removeFromCart(foodId) {\n      this.cart.items = this.cart.items.filter(item => item.food.id != foodId);\n      this.setCartToLocalStorage();\n    }\n\n    changeQuantity(foodId, quantity) {\n      let cartItem = this.cart.items.find(item => item.food.id === foodId);\n      if (!cartItem) return;\n      cartItem.quantity = quantity;\n      cartItem.price = quantity * cartItem.food.price;\n      this.setCartToLocalStorage();\n    }\n\n    clearCart() {\n      this.cart = new Cart();\n      this.setCartToLocalStorage();\n    }\n\n    getCartObservable() {\n      return this.cartSubject.asObservable();\n    }\n\n    setCartToLocalStorage() {\n      this.cart.totalPrice = this.cart.items.reduce((prevSum, currentItem) => prevSum + currentItem.price, 0);\n      this.cart.totalCount = this.cart.items.reduce((prevSum, currentItem) => prevSum + currentItem.quantity, 0);\n      const cartJson = JSON.stringify(this.cart);\n      localStorage.setItem('Cart', cartJson);\n      this.cartSubject.next(this.cart);\n    }\n\n    getCartFromLocalStorage() {\n      const cartJson = localStorage.getItem('Cart');\n      return cartJson ? JSON.parse(cartJson) : new Cart();\n    }\n\n  }\n\n  CartService.ɵfac = function CartService_Factory(t) {\n    return new (t || CartService)();\n  };\n\n  CartService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: CartService,\n    factory: CartService.ɵfac,\n    providedIn: 'root'\n  });\n  return CartService;\n})();","map":null,"metadata":{},"sourceType":"module"}